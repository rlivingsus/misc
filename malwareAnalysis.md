Calling conventions in reverse engineering
-rules when calling and returning values by a function
-focus on visual studio
-x86 calling conventions
--return value always returned in EAX register
--DWORDs are 32 bits if return value is of 64 bit (QWORD) then returned in EDX:EAX
--MSDN good source of information
--ESI, EDI, EBX, and EBP are contant (non-volatile)
-__cdecl default calling convention for C/C++; arguments are pushed on the stack from right to left.  Looks like:
--push edi		;envp
--push esi		;argv
--push dword ptr [eax]	;argc
----
---Beginner Malware Analysis Course
--Setting Up a Safe Environment
-Virtual Box, VMWare, Windows 7 (64-bit if possible)
-4-8 GB RAM, 50+ GB, 1-2+ Processor Cores
-Flare VM script by FireEye
-2 VM, a static with IDA Pro and connect to internet so no running process.  Use process hacker to check.  Flare-VM for detonation and dynamic analysis (debugging).  No difference between the two just snapshots more frequently.
-C:\user\rlivings\desktop\
-Windows 7 for Flare-VM. .\install.ps1 did not work so I ended installing manually but Chocolatey requires PowerShell v3 or higher due to TLS upgrades.  Chocolatey definitely not there since CINST didn't work.
-Needed to enable TLS1.2 in powershell.  https://johnlouros.com/blog/enabling-strong-cryptography-for-all-dot-net-applications this didnt help
-Check powershell version "$host.Version"
-Installed updates too (windows) took time.  Issues installing 2019-09 & 2020-01 with a Windows update encountered an unknown error Code 80092004 error so the recommendation was to install KB4490628 fixes below:
https://support.microsoft.com/en-us/help/4490628/servicing-stack-update-for-windows-7-sp1-and-windows-server-2008-r2
http://www.catalog.update.microsoft.com/search.aspx?q=4490628
worked
-https://github.com/PowerShell/PowerShell/releases for newer versions of Powershell since I was at v2 but first needed Windows Management Framework 4.0 or newer from https://aka.ms/pscore6-prereq (where you'll install Universal C runtime, installed on fully patched machines & install WMF).  Installed WMF 5.1 for Windows & via KB3191566
-Installed Chocolatey (cuz FlameVM steps didnt work again): https://chocolatey.org/docs/installation#install-with-powershellexe checked by using cinst command
-Install Boxstarter: CINST Boxstarter https://boxstarter.org/InstallBoxstarter
-Installed manually via fireeye/flare-vm instructions and Powershell v3 (or more): Set-ExecutionPolicy Unrestricted
. { iwr -useb http://boxstarter.org/bootstrapper.ps1 } | iex; get-boxstarter -Force //this basically installs boxstarter but I did that manually already.
-Install the actual flare-vm package: Install-BoxstarterPackage -PackageName https://raw.githubusercontent.com/fireeye/flare-vm/master/install.ps1 
-supposedly: cup all  //used to stay up to date.  WORKED!
-issues installing one patch on second static system (not the same error as the dynamic system) but I realized I could just clone the finished dynamic system and then modify the VM settings so one is a NON connected VM
--The Many Variation of Malware+Terminology
-Droppers which "drop" embedded files and is typically spread via malspam in Word or Excel documents.  Embedded executable installed somewhere in the computer or temp
-Downloaders same as droppers except 2nd stage is retrieved remotely from a C2 server
-infostealer & keyloggers (with data exfiltration and maybe encryption)
-API to look out for (keyloggers) are GetAsyncKeyState(), SetWindowsHookEx(), GetForegroundWindow()
-Things to look out for (Stealer): SQLite3 usage, Firefox DLL Usage (nss, mozglue,…), Calls to CryptUnprotectData()
-SpamBot: to join a botnet if on computer
-Banker: banker trojans to steal banker specifics using webinjection or API hooking which allows malware to modify specific API so that it's own code runs - instead of the API function.
-Worms propogate across a network with zero interaction sometimes.
-Ransomware encrypts files asking for payment.  When compiled with worms then bad.  Cryptocurrency makes this a high payoff/low risk for criminals
-Miners: mine cryptocurrency on victim's machine.
-Backdoor: attackers hidden remote access to the system with ability to access via cmd line
-Terminology 
-Packed/Packer (or crypted): takes an executable or DLL and compresses/encrypts/obfuscates which is then stored in another exe known as a Stub.  The stub contains the unpacking mechanism and loads the packed file via some injection normally.  Most malware these days are packed.
-Obfuscation: obscured text, often used for plaintext script like Javascript or Powershell to slow down analysis.  Strings in malware are sometimes obfuscated & can also be encrypted too
-Disassemblers: used for static analysis of malware when file is not being executed.  Much more difficult as cannot view memory regions in the file (since they do not exist).  Used to get an idea of how the sample functions before executing in debugger.  Examples, Binary Ninja, IDA Pro, Hopper, Radare
-Debuggers: analyze memory in runtime, dynamic and access all memory.  Multipurpose.  Examples, immunity, x32/64debug, gdb, windebug, ollydebug
-IOC: Indicators of Compromises: files names, hashes, type, email addresses
IsDebuggerPresent //function in malware analysis normally malware
//check import tab in IDA and if not many (like 1) then author may be hiding something. Open subviewstrings to see more such as “isDebuggerPresent”
//If something looks suspicious, remember address in IDA then go to debugger and set a breakpoint. IDA for static analysis then Debugger can run program for dynamic analysis. So once program hits breakpoint can step over/through code. 
//GetModuleHandle lets malware spot loaded DLLs
//CreateToolhelp32Snapshot obtains a list of running processes which may be suspicious
--Analysis of .NET Malware
-

---Zero2Hero (beginners malware analysis before Zero2Auto)
--How Attackers Gain Footholds

